#!/bin/bash

# Remove unnecessary pre-installed packages
echo "Removing unnecessary packages..."
sudo apt-get purge -y cheese* aisleriot five-or-more four-in-a-row hitori lightsoff quadrapassel swell-foop tali
sudo apt autoremove -y
sudo apt clean

# Update the system
echo "Updating system..."
sudo apt update -y
sudo apt upgrade -y
sudo apt full-upgrade -y
sudo apt dist-upgrade -y

# Install essential utilities
echo "Installing essential utilities..."
sudo apt install -y git curl wget unzip nano build-essential

# Install penetration testing tools
echo "Install pythonvenv.."
sudo apt install python3.11-venv

echo "Installing Nmap..."
sudo apt install -y nmap

echo "Installing Wireshark..."
sudo apt install -y wireshark

echo "Installing John the Ripper..."
sudo apt install -y john

echo "Installing aircrack-ng and hydra..."
sudo apt install -y aircrack-ng hydra

echo "Installing binwalk and exiftool..."
sudo apt install -y binwalk exiftool

# Install additional useful tools
echo "Installing netcat-openbsd, ncat, tcpdump, hashcat, ffuf, proxychains, and git..."
sudo apt install -y netcat-openbsd ncat tcpdump hashcat ffuf proxychains git

# Install Nuclei
echo "Installing Nuclei..."
go install -v github.com/projectdiscovery/nuclei/v3/cmd/nuclei@latest

# Install DirSearch
echo "Cloning DirSearch repository..."
git clone --depth 1 https://github.com/maurosoria/dirsearch.git ~/tools/dirsearch

# Create a symlink to use DirSearch globally
echo "Creating symlink for DirSearch..."
sudo ln -sf ~/tools/dirsearch/dirsearch.py /usr/local/bin/dirsearch

# Ensure the Python executable is correct (if needed)
echo "Checking Python version..."
if ! command -v python3 &> /dev/null; then
    echo "Python 3 is not installed. Installing Python 3..."
    sudo apt install python3
fi

# Create a symlink for python if it doesn't exist
if ! command -v python &> /dev/null; then
    echo "Creating symlink for Python..."
    sudo ln -s /usr/bin/python3 /usr/bin/python
fi

# Install required Python dependencies
echo "Installing Python dependencies..."
pip3 install defusedxml --break-system-packages

# Test the installation
echo "Testing DirSearch installation..."
dirsearch --help

# Install Waybackurls using Go
echo "Installing Waybackurls..."
go install github.com/tomnomnom/waybackurls@latest

# Install sqlmap
echo "Installing sqlmap..."
git clone --depth 1 https://github.com/sqlmapproject/sqlmap.git ~/tools/sqlmap-dev

# Create a symlink to use sqlmap globally
echo "Creating symlink for sqlmap..."
sudo ln -sf ~/tools/sqlmap-dev/sqlmap.py /usr/local/bin/sqlmap

# Ensure the Python executable is correct (if needed)
echo "Checking Python version..."
if ! command -v python3 &> /dev/null; then
    echo "Python 3 is not installed. Installing Python 3..."
    sudo apt install python3
fi

# Create a symlink for python if it doesn't exist
if ! command -v python &> /dev/null; then
    echo "Creating symlink for Python..."
    sudo ln -s /usr/bin/python3 /usr/bin/python
fi

# Test the installation
echo "Testing sqlmap installation..."
sqlmap -h

# Check if Metasploit (msfconsole) is already installed
if command -v msfconsole &>/dev/null; then
    echo "Metasploit is already installed. Skipping installation."
else
    echo "Installing Metasploit Framework..."
    curl https://raw.githubusercontent.com/rapid7/metasploit-omnibus/master/config/templates/metasploit-framework-wrappers/msfupdate.erb > msfinstall
    chmod 755 msfinstall
    ./msfinstall
    rm msfinstall
fi

# Enable Wireshark for non-root users (Optional)
sudo usermod -aG wireshark $(whoami)

# Clean up
echo "Cleaning up..."
sudo apt autoremove -y
sudo apt clean

echo "Penetration Testing tools installation complete!"

# Reminder to install Burp Suite manually
echo ""
echo "========================================"
echo "REMINDER: Install Burp Suite manually from:"
echo "https://portswigger.net/burp/releases/professional-community-2024-12-1?requestededition=community&requestedplatform="
echo "========================================"

# Reminder to install ZAP Proxy
echo "========================================"
echo "REMINDER: Install ZAP Proxy from:"
echo "https://www.zaproxy.org/download/"
echo "========================================"

# Reminder to install xfreerdp
echo "========================================"
echo "REMINDER: Install xfreerdp from FreeRDP GitHub release:"
echo "https://github.com/FreeRDP/FreeRDP/releases/tag/3.10.3"
echo "========================================"
echo ""
